<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>js csv文件下载</title>
</head>

<body>
    <div class="demo"> </div>
    <script type="text/javascript" charset="utf-8">
        var people = [{
            "name": "吴三桂",
            "phone": "18709237410",
            "level": "黄金",
            "birthday": "1989/8/5",
            "points": "100"
        }, {
            "name": "史泰龙",
            "phone": "18709237401",
            "level": "青铜2",
            "birthday": "1993/9/6",
            "points": "300"
        }, {
            "name": "阿超",
            "phone": "18883920287",
            "level": "白金",
            "birthday": "1993/9/3",
            "points": "500"
        }];

        //s1.用一个数组来存一行数据, 所以第一行用一个数组来保存字段名
        var head = [
            ['姓名（最多10个字）', '手机号（必填）', '等级', '生日（比如：1989/08/08 或 1989-08-08）', '积分（限整数）']
        ];
        //s2. 将数据push到大数组中 
        var p = people;
        for (var i = 0; i < p.length; i++) {
            head.push([p[i].name, p[i].phone, p[i].level, p[i].birthday, p[i].points]);
        }
        //s3. 按照csv文件内容格式，把每个数组用 , 连接，形成一行，并存入新数组 
        var csvRows = [];
        for (var j = 0; j < head.length; j++) {
            csvRows.push(head[j].join(','))
        }
        //s4. 把新数组用 \n 回车连接，形成csvString 
        var csvString = csvRows.join('\n'); //BOM的方式解决EXCEL乱码问题 

        var BOM = '\uFEFF';
        csvString = BOM + csvString;

        //s5. 创建a标签
        var a = document.createElement('a');
        a.setAttribute("href", 'data:attachment/csv,' + encodeURI(csvString));
        a.setAttribute("target", '_blank');
        a.setAttribute("download", '会员.csv');
        // 插入到HTML 中，点击实现下载，然后移除元素
        document.querySelector('.demo').appendChild(a);
        a.click();
        document.querySelector('.demo').removeChild(a);
    </script>
</body>

</html>